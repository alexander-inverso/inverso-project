<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visor_Analítico_Fullscreen</title>
    <style>
        :root {
            --bg-color: #000000;
            --text-color: #f0f0f0;
            --accent-color: #ff3333;
            --font-stack: 'Courier New', Courier, monospace;
            --ui-bg: rgba(10, 10, 10, 0.85);
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            font-family: var(--font-stack);
            overflow: hidden; /* Evita scrollbar global del body */
        }

        /* --- CONTENEDOR INFINITO --- */
        .viewport-layer {
            width: 100vw;
            height: 100vh;
            overflow-x: auto;
            overflow-y: hidden;
            display: flex;
            
            /* Física de anclaje estricta */
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;

            /* Ocultar barras de desplazamiento visuales */
            scrollbar-width: none; 
            -ms-overflow-style: none;
        }

        .viewport-layer::-webkit-scrollbar {
            display: none;
        }

        /* --- ITEMS --- */
        .carousel-item {
            flex: 0 0 100vw; /* Ancho forzado a pantalla completa */
            height: 100vh;   /* Alto forzado a pantalla completa */
            scroll-snap-align: start;
            position: relative;
            
            /* Centrado de la imagen */
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            overflow: hidden;
        }

        /* --- IMAGEN TÉCNICA --- */
        .img-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform;
        }

        .carousel-item img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* La imagen nunca se recorta, se ajusta */
            user-select: none;
            -webkit-user-drag: none;
        }

        /* --- DATOS FLOTANTES (Top Left) --- */
        .meta-layer {
            position: absolute;
            top: 30px;
            left: 30px;
            color: var(--text-color);
            background: rgba(0, 0, 0, 0.6);
            padding: 10px;
            border-left: 2px solid var(--accent-color);
            font-size: 0.85rem;
            z-index: 10;
            pointer-events: none;
            backdrop-filter: blur(2px);
        }

        /* --- HUD DE CONTROL (Bottom Center) --- */
        .hud-controls {
            position: fixed; /* Anclaje absoluto a la ventana */
            bottom: 40px;    /* Distancia del borde inferior */
            left: 50%;
            transform: translateX(-50%); /* Centrado geométrico exacto */
            z-index: 100;
            
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            
            width: 90%;
            max-width: 500px;
            padding: 15px;
            background: var(--ui-bg);
            border: 1px solid #333;
            border-radius: 4px;
        }

        .status-text {
            font-size: 0.9rem;
            letter-spacing: 2px;
            color: #888;
            font-weight: bold;
        }

        .button-cluster {
            display: flex;
            gap: 15px;
            flex-wrap: nowrap;
        }

        /* --- BOTONES --- */
        button {
            background: transparent;
            border: 1px solid #555;
            color: var(--text-color);
            padding: 10px 18px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.8rem;
            text-transform: uppercase;
            transition: all 0.2s;
            min-width: 40px;
        }

        button:hover {
            background: #222;
            border-color: var(--text-color);
        }

        button:active {
            background: var(--accent-color);
            color: #000;
            border-color: var(--accent-color);
        }

        /* Separador vertical visual */
        .sep {
            width: 1px;
            background: #444;
            height: 100%;
            margin: 0 5px;
        }

    </style>
</head>
<body>

    <div class="viewport-layer" id="mainScroll">
        
        <div class="carousel-item" id="item-1">
            <div class="img-wrapper" id="zoom-1">
                <img src="https://github.com/alexander-inverso/inverso-project/blob/49b679585ddb33d6452274bf43488d3ab450296a/RELR/20260203_125116.jpg?raw=true" alt="Cromatografía con capilares">
            </div>
            <div class="meta-layer">
                <div>IMG_ID: 001</div>
                <div>METODO: ARRASTRE</div>
            </div>
        </div>

        <div class="carousel-item" id="item-2">
            <div class="img-wrapper" id="zoom-2">
                <img src="https://github.com/alexander-inverso/inverso-project/blob/49b679585ddb33d6452274bf43488d3ab450296a/RELR/20260128_162756.jpg?raw=true" alt="Cromatografía con vasos">
            </div>
            <div class="meta-layer">
                <div>IMG_ID: 002</div>
                <div>METODO: CAPILARIDAD</div>
            </div>
        </div>

        <div class="carousel-item" id="item-3">
            <div class="img-wrapper" id="zoom-3">
                <img src="https://github.com/alexander-inverso/inverso-project/blob/49b679585ddb33d6452274bf43488d3ab450296a/RELR/Imagen.png?raw=true" alt="Escaneo">
            </div>
            <div class="meta-layer">
                <div>IMG_ID: 003</div>
                <div>METODO: ESCANEO</div>
            </div>
        </div>

    </div>

    <div class="hud-controls">
        <div class="status-text" id="statusLog">DATA: 01 / 03</div>
        
        <div class="button-cluster">
            <button onclick="nav(-1)">&#9664;</button> <button onclick="nav(1)">&#9654;</button>  <div class="sep"></div>
            
            <button onclick="zoom(-1)">[-]</button>
            <button onclick="reset()">1:1</button>
            <button onclick="zoom(1)">[+]</button>
        </div>
    </div>

    <script>
        const scrollContainer = document.getElementById('mainScroll');
        const statusLog = document.getElementById('statusLog');
        const items = document.querySelectorAll('.carousel-item');
        
        // Estado
        let currentIdx = 1;
        let zoomLevel = 1;
        
        // --- NAVEGACIÓN ---
        function nav(direction) {
            // Resetear zoom al cambiar para evitar desorientación
            reset();
            
            // Scroll nativo (100vw * dirección)
            const width = window.innerWidth;
            scrollContainer.scrollBy({
                left: width * direction,
                behavior: 'smooth'
            });
        }

        // --- ZOOM LÓGICO ---
        function zoom(dir) {
            zoomLevel += (dir * 0.5);
            // Límites de seguridad (0.5x a 5x)
            if (zoomLevel < 0.5) zoomLevel = 0.5;
            if (zoomLevel > 5) zoomLevel = 5;
            
            applyTransform();
        }

        function reset() {
            zoomLevel = 1;
            applyTransform();
        }

        function applyTransform() {
            // Aplicar solo a la imagen activa para ahorrar memoria
            const activeWrapper = document.getElementById(`zoom-${currentIdx}`);
            if(activeWrapper) {
                activeWrapper.style.transform = `scale(${zoomLevel})`;
            }
        }

        // --- OBSERVER (Detección de posición) ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Extraer índice del ID "item-X"
                    const id = entry.target.id;
                    currentIdx = parseInt(id.split('-')[1]);
                    
                    // Actualizar HUD
                    statusLog.innerText = `DATA: 0${currentIdx} / 0${items.length}`;
                    
                    // Asegurar reset de zoom si el usuario hizo swipe manual
                    if (zoomLevel !== 1) reset(); 
                }
            });
        }, { threshold: 0.5 }); // Detectar cuando el 50% de la imagen es visible

        items.forEach(i => observer.observe(i));

        // --- ARRASTRE DE ZOOM (Básico) ---
        // Permite mover la imagen cuando está ampliada
        let isDragging = false;
        let startX, startY, translateX = 0, translateY = 0;

        items.forEach(item => {
            const wrapper = item.querySelector('.img-wrapper');
            
            wrapper.addEventListener('mousedown', (e) => {
                if(zoomLevel > 1) {
                    isDragging = true;
                    startX = e.clientX - translateX;
                    startY = e.clientY - translateY;
                    wrapper.style.cursor = 'grabbing';
                }
            });

            window.addEventListener('mouseup', () => {
                isDragging = false;
                if(wrapper) wrapper.style.cursor = 'default';
            });

            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                e.preventDefault();
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                wrapper.style.transform = `scale(${zoomLevel}) translate(${translateX / zoomLevel}px, ${translateY / zoomLevel}px)`;
            });
        });

    </script>
</body>
</html>
