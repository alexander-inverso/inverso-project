<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cromatografía: Extracción de Carotenoides | Reporteros en la Red</title>
    <style>
        :root {
            --bg-color: #000000;
            --ui-bg: rgba(0, 0, 0, 0.6); /* Fondo semitransparente para UI */
            --text-color: #e0e0e0;
            --accent-color: #00ff41; /* Verde técnico */
            --font-stack: 'Segoe UI', 'Roboto', 'Courier New', monospace;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-stack);
            width: 100vw;
            height: 100vh;
            overflow: hidden; /* Sin barras de scroll del navegador */
        }

        /* --- CAPA 1: VISOR (Fondo Z-Index 0) --- */
        .carousel-viewport {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .carousel-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease-in-out;
        }

        .carousel-item.active {
            opacity: 1;
            pointer-events: all;
        }

        /* Capa de transformación para Zoom/Pan */
        .transform-layer {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform-origin: 0 0; 
            will-change: transform;
            cursor: grab;
        }

        .transform-layer:active {
            cursor: grabbing;
        }

        .carousel-item img {
            /* LÓGICA DE DIMENSIONES: */
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain; /* NUNCA RECORTAR */
            user-select: none;
            box-shadow: 0 0 50px rgba(0,0,0,0.8); /* Sombra para separar del fondo negro */
        }

        /* --- CAPA 2: INTERFAZ (HUD Z-Index 100) --- */
        
        /* HEADER FLOTANTE */
        header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px 40px;
            box-sizing: border-box;
            background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0) 100%);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            z-index: 100;
            pointer-events: none; /* Dejar pasar clics en zonas vacías */
        }

        .project-info {
            pointer-events: auto; /* Reactivar clics en el texto */
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        }

        .project-info h1 {
            font-size: 1.2rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #fff;
        }

        .project-info h2 {
            font-size: 0.9rem;
            margin: 5px 0 0 0;
            color: var(--accent-color);
            font-weight: normal;
        }

        .meta-data {
            text-align: right;
            font-size: 0.8rem;
            color: #aaa;
            pointer-events: auto;
        }

        /* ETIQUETA DE DATOS (Overlay en la imagen) */
        .image-label {
            position: absolute;
            bottom: 100px; /* Encima de los controles */
            left: 40px;
            background: rgba(0, 0, 0, 0.7);
            border-left: 2px solid var(--accent-color);
            padding: 10px 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            max-width: 400px;
            z-index: 90;
            backdrop-filter: blur(4px);
            pointer-events: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .carousel-item.active .image-label {
            opacity: 1;
            transform: translateY(0);
        }

        /* BARRA DE CONTROL INFERIOR */
        .controls-bar {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--ui-bg);
            padding: 10px 20px;
            border-radius: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .btn {
            background: transparent;
            border: none;
            color: #fff;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            padding: 8px 15px;
            border-radius: 4px;
            transition: background 0.2s, color 0.2s;
        }

        .btn:hover {
            background: rgba(255,255,255,0.1);
            color: var(--accent-color);
        }

        .status-text {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--accent-color);
            border-right: 1px solid #555;
            border-left: 1px solid #555;
            padding: 0 20px;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            header { padding: 15px; flex-direction: column; }
            .meta-data { display: none; } /* Ocultar detalles en móvil para ver foto */
            .controls-bar { width: 90%; justify-content: space-between; bottom: 20px; }
            .image-label { left: 10px; right: 10px; bottom: 90px; max-width: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="project-info">
            <h1>Extracción de Carotenoides</h1>
            <h2>Reporteros en la Red</h2>
        </div>
        <div class="meta-data">
            <div>Autor: Alexander de Toro Todorov</div>
            <div>IES Radio Exterior Alicante</div>
        </div>
    </header>

    <div class="carousel-viewport">
        
        <div class="carousel-item active">
            <div class="transform-layer">
                <img src="https://github.com/alexander-inverso/inverso-project/blob/main/RELR/Imagen.png?raw=true" alt="Escaneo HD">
            </div>
            <div class="image-label">
                <strong>REF: ESCANEO_HD</strong><br>
                Digitalización de alta resolución de las bandas de papel de filtro tras el proceso de cromatografía.
            </div>
        </div>

        <div class="carousel-item">
            <div class="transform-layer">
                <img src="https://github.com/alexander-inverso/inverso-project/blob/main/RELR/20260203_125116.jpg?raw=true" alt="Técnica Arrastre">
            </div>
            <div class="image-label">
                <strong>REF: TÉCNICA_ARRASTRE</strong><br>
                Resultado visual utilizando la técnica experimental de arrastre de pigmentos.
            </div>
        </div>

        <div class="carousel-item">
            <div class="transform-layer">
                <img src="https://github.com/alexander-inverso/inverso-project/blob/main/RELR/20260128_162756.jpg?raw=true" alt="Capilaridad Sencilla">
            </div>
            <div class="image-label">
                <strong>REF: CAPILARIDAD_BANDEJA</strong><br>
                Prueba de separación mediante capilaridad sencilla en entorno de bandeja plástica.
            </div>
        </div>

    </div>

    <div class="controls-bar">
        <button class="btn" onclick="changeSlide(-1)">&#8592; Prev</button>
        <div class="status-text" id="status-counter">01 / 03</div>
        <button class="btn" onclick="changeSlide(1)">Next &#8594;</button>
        <button class="btn" onclick="resetZoom()" style="font-size:0.8rem; opacity:0.7">[ RESET VISTA ]</button>
    </div>

    <script>
        // CONFIGURACIÓN
        const items = document.querySelectorAll('.carousel-item');
        const counter = document.getElementById('status-counter');
        let currentIndex = 0;

        // ESTADO DE VISTA (ZOOM/PAN)
        let viewStates = Array.from({length: items.length}, () => ({
            scale: 1,
            pointX: 0,
            pointY: 0,
            isDragging: false,
            startX: 0,
            startY: 0
        }));

        const MIN_ZOOM = 0.8; // Permite alejar un poco más para ver márgenes
        const MAX_ZOOM = 12;  // Zoom potente para ver detalles del papel
        const ZOOM_SENSITIVITY = 0.001; // Ajuste fino para trackpad/rueda

        // INICIALIZACIÓN
        updateUI();
        attachEvents();

        // 1. NAVEGACIÓN
        function changeSlide(dir) {
            items[currentIndex].classList.remove('active');
            
            currentIndex += dir;
            if (currentIndex < 0) currentIndex = items.length - 1;
            if (currentIndex >= items.length) currentIndex = 0;
            
            items[currentIndex].classList.add('active');
            updateUI();
        }

        function updateUI() {
            counter.innerText = `0${currentIndex + 1} / 0${items.length}`;
            applyTransform(currentIndex);
        }

        // 2. MOTOR GRÁFICO (ZOOM Y PAN)
        function attachEvents() {
            items.forEach((slide, index) => {
                const container = slide; 
                
                // ZOOM (Rueda)
                container.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    
                    const state = viewStates[index];
                    const rect = container.getBoundingClientRect();
                    
                    // Coordenadas relativas al contenedor
                    const mouseX = e.clientX - rect.left;
                    const mouseY = e.clientY - rect.top;

                    // Calcular desplazamiento del zoom
                    // deltaY negativo es zoom in
                    const delta = -e.deltaY;
                    const factor = 1 + (delta * 0.001); // Factor de escala suave

                    const newScale = Math.min(Math.max(state.scale * factor, MIN_ZOOM), MAX_ZOOM);
                    
                    // Matemáticas para hacer zoom hacia el cursor
                    // (pos_cursor - pos_actual) * (1 - factor_escala)
                    // Ajustamos el desplazamiento para mantener el punto bajo el ratón
                    if (newScale !== state.scale) {
                        const scaleRatio = newScale / state.scale;
                        state.pointX = mouseX - (mouseX - state.pointX) * scaleRatio;
                        state.pointY = mouseY - (mouseY - state.pointY) * scaleRatio;
                        state.scale = newScale;
                    }

                    applyTransform(index);
                }, { passive: false });

                // ARRASTRE (Mouse)
                container.addEventListener('mousedown', (e) => {
                    // Evitar arrastre si no hay zoom (opcional, pero mejora UX)
                    viewStates[index].isDragging = true;
                    viewStates[index].startX = e.clientX - viewStates[index].pointX;
                    viewStates[index].startY = e.clientY - viewStates[index].pointY;
                    container.querySelector('.transform-layer').style.cursor = 'grabbing';
                });

                window.addEventListener('mousemove', (e) => {
                    if (index !== currentIndex || !viewStates[index].isDragging) return;
                    e.preventDefault();
                    
                    const state = viewStates[index];
                    state.pointX = e.clientX - state.startX;
                    state.pointY = e.clientY - state.startY;
                    applyTransform(index);
                });

                window.addEventListener('mouseup', () => {
                    if (viewStates[index].isDragging) {
                        viewStates[index].isDragging = false;
                        container.querySelector('.transform-layer').style.cursor = 'grab';
                    }
                });
            });
        }

        function applyTransform(index) {
            const state = viewStates[index];
            const layer = items[index].querySelector('.transform-layer');
            // Matriz simple: mover y luego escalar
            layer.style.transform = `translate(${state.pointX}px, ${state.pointY}px) scale(${state.scale})`;
        }

        function resetZoom() {
            viewStates[currentIndex] = {
                scale: 1,
                pointX: 0,
                pointY: 0,
                isDragging: false,
                startX: 0,
                startY: 0
            };
            applyTransform(currentIndex);
        }

        // Navegación por teclado
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'Escape') resetZoom();
        });
    </script>
</body>
</html>
